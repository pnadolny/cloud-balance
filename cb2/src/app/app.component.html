<md-toolbar color="primary">
  <span>Cloud Balance<br><div style="font-weight: 300;
    font-size: 12px;">{{emailAddress}}&nbsp;&nbsp; <a mdTooltip="Sign off" style="color:white" href="{{logoutURL}}">Sign out</a>
</div></span>



  <span class="flex-right"></span>

  <span *ngIf="balanceBeforeIncome!=0" mdTooltip="Balance just before Income">{{balanceBeforeIncome | currency:'USD':true}}<br><div style="font-weight: 300;
    font-size: 12px;">Balance before <span class="tag tag-default tag-pill payee-type-i">I</span></div></span>

  <span class="flex-right"></span>

  <span mdTooltip="Today's balance">{{todaysBalance | currency:'USD':true}}<br><div style="font-weight: 300;
    font-size: 12px;">{{todaysDate}}</div></span>


</md-toolbar>

<div class="content">


  <md-tab-group>

    <md-tab label="Transactions&nbsp;({{count}})">

      <div *ngIf="!searching">
        <button md-tooltip="Create a Transaction" tooltip-position="below" md-button color="primary"
                (click)="editTransaction(null,true)">
          <md-icon mdTooltip="Create a new Transaction">create</md-icon>
          &nbsp;Create
        </button>

        <button md-tooltip="Search" tooltip-position="below" md-button color="primary"
                (click)="searching=true">

          <md-icon>search</md-icon>
          &nbsp;Search
        </button>


      </div>

      <div *ngIf="searching" style="display: flex;flex-direction: column;flex-grow: 1;">

          <button md-tooltip="Close" tooltip-position="below" md-button color="primary"
                  (click)="_filters.month=null;searching=false">
            <md-icon>close</md-icon>
            &nbsp;Close

          </button>
          <filters-cmp (change)="handleFiltersChange($event)"></filters-cmp>



      </div>



      <table class="mdDataTable">
        <thead>
        <tr>
          <th class="leftAlignedColumn">Date</th>
          <th class="leftAlignedColumn">Payee</th>
          <th class="leftAlignedColumn">Amount</th>
          <th class="leftAlignedColumn">Balance</th>
          <th class="rightAlignedColumn">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let transaction of transactions | async; let i = index" [class.selected]="transaction.today">
          <td class="column leftAlignedColumn">{{transaction.date | date:'shortDate'}}</td>
          <td><span
            class="tag tag-default tag-pill payee-type-{{transaction.type}}">{{transaction.type | uppercase}}</span>&nbsp;{{transaction.payee}}
          </td>
          <td class="column leftAlignedColumn">{{transaction.amount | currency:'USD':true}}</td>
          <td class="column leftAlignedColumn">{{transaction.balance | currency:'USD':true}}</td>
          <td class="rightAlignedColumn">
            <div>
              <md-icon mdTooltip="Edit" (click)="editTransaction(transaction)">edit</md-icon>
              &nbsp;
              <md-icon mdTooltip="Delete" (click)="delete(transaction)">delete_forever</md-icon>
              &nbsp;
              <md-icon mdTooltip="Copy" (click)="copy(transaction)">content_copy</md-icon>
              &nbsp;
              <md-icon mdTooltip="Copy to next month" (click)="copy(transaction,true)">filter_1</md-icon>
              &nbsp;
            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </md-tab>


    <md-tab label="Cash Flow">
      <table class="mdDataTable">
        <thead>
        <tr>
          <th>Month</th>
          <th><span class="tag tag-default tag-pill payee-type-i">I</span>&nbsp;Income</th>
          <th><span class="tag tag-default tag-pill payee-type-s">S</span>&nbsp;Static</th>
          <th><span class="tag tag-default tag-pill payee-type-d">D</span>&nbsp;Discretionary</th>
          <th><span class="tag tag-default tag-pill payee-type-f">F</span>&nbsp;Future</th>
          <th><span class="tag tag-default tag-pill payee-type-o">O</span>&nbsp;Other</th>
          <th>Cash Flow</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let cf of cashFlow " [class.selected]="cf.thisMonth">
          <td>{{cf.month}}</td>
          <td>{{cf.income | currency:'USD':true }}</td>
          <td>{{cf.static | currency:'USD':true }}</td>
          <td>{{cf.discretionary | currency:'USD':true }}</td>
          <td>{{cf.future | currency:'USD':true }}</td>
          <td>{{cf.other | currency:'USD':true }}</td>
          <td>{{cf.monthlyCashFlow | currency:'USD':true }}</td>
        </tr>
        </tbody>
      </table>
    </md-tab>

    <md-tab label="Payees&nbsp;({{payeeCount}})">
      <button md-tooltip="Create a Payee" tooltip-position="below" md-button color="primary"
              (click)="editPayee(null,true)">
        <md-icon>create</md-icon>
        &nbsp;Create
      </button>
      <table class="mdDataTable">
        <thead>
        <tr>
          <th>Name</th>
          <th>{{currentMonth}}</th>
          <th>Total</th>
          <th class="rightAlignedColumn">Action</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let payee of payees | async; let i = index">
          <td><span class="tag tag-default tag-pill payee-type-{{payee.type}}">{{payee.type | uppercase}}</span>&nbsp;{{payee.name}}
          </td>
          <td>{{payee.thisMonth | currency:'USD':true}}</td>
          <td>{{payee.total | currency:'USD':true}}</td>
          <td class="rightAlignedColumn">
            <md-icon (click)="editPayee(payee)">edit</md-icon>
            &nbsp;
            <md-icon (click)="deletePayee(payee)">delete_forever</md-icon>
          </td>
        </tr>
        </tbody>
      </table>
    </md-tab>
  </md-tab-group>

</div>

